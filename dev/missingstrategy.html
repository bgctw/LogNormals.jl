<!DOCTYPE html>
<html lang="en"><head><meta charset="UTF-8"/><meta name="viewport" content="width=device-width, initial-scale=1.0"/><title>Strategies for missings · LogNormals.jl</title><link href="https://fonts.googleapis.com/css?family=Lato|Roboto+Mono" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/fontawesome.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/solid.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.15.0/css/brands.min.css" rel="stylesheet" type="text/css"/><link href="https://cdnjs.cloudflare.com/ajax/libs/KaTeX/0.11.1/katex.min.css" rel="stylesheet" type="text/css"/><script>documenterBaseURL="."</script><script src="https://cdnjs.cloudflare.com/ajax/libs/require.js/2.3.6/require.min.js" data-main="assets/documenter.js"></script><script src="siteinfo.js"></script><script src="../versions.js"></script><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-dark.css" data-theme-name="documenter-dark" data-theme-primary-dark/><link class="docs-theme-link" rel="stylesheet" type="text/css" href="assets/themes/documenter-light.css" data-theme-name="documenter-light" data-theme-primary/><script src="assets/themeswap.js"></script></head><body><div id="documenter"><nav class="docs-sidebar"><div class="docs-package-name"><span class="docs-autofit">LogNormals.jl</span></div><form class="docs-search" action="search.html"><input class="docs-search-query" id="documenter-search-query" name="q" type="text" placeholder="Search docs"/></form><ul class="docs-menu"><li><a class="tocitem" href="index.html">Home</a></li><li><a class="tocitem" href="lognormalprops.html">LogNormal properties</a></li><li><a class="tocitem" href="fitstats.html">Fit to statistic</a></li><li><a class="tocitem" href="distributionvector.html">Vector of random variables</a></li><li><a class="tocitem" href="sumdist.html">Sum of random variables</a></li><li><a class="tocitem" href="sumnormals.html">Sum Normals</a></li><li><a class="tocitem" href="sumlognormals.html">Sum LogNormals</a></li><li class="is-active"><a class="tocitem" href="missingstrategy.html">Strategies for missings</a><ul class="internal"><li><a class="tocitem" href="#Example:-Autocorrelation"><span>Example: Autocorrelation</span></a></li><li><a class="tocitem" href="#Type-stability"><span>Type stability</span></a></li><li><a class="tocitem" href="#Design-choices"><span>Design choices</span></a></li></ul></li><li><a class="tocitem" href="semcor.html">sem correlated</a></li></ul><div class="docs-version-selector field has-addons"><div class="control"><span class="docs-label button is-static is-size-7">Version</span></div><div class="docs-selector control is-expanded"><div class="select is-fullwidth is-size-7"><select id="documenter-version-selector"></select></div></div></div></nav><div class="docs-main"><header class="docs-navbar"><nav class="breadcrumb"><ul class="is-hidden-mobile"><li class="is-active"><a href="missingstrategy.html">Strategies for missings</a></li></ul><ul class="is-hidden-tablet"><li class="is-active"><a href="missingstrategy.html">Strategies for missings</a></li></ul></nav><div class="docs-right"><a class="docs-edit-link" href="https://github.com/bgctw/LogNormals.jl/blob/master/docs/src/missingstrategy.md" title="Edit on GitHub"><span class="docs-icon fab"></span><span class="docs-label is-hidden-touch">Edit on GitHub</span></a><a class="docs-settings-button fas fa-cog" id="documenter-settings-button" href="#" title="Settings"></a><a class="docs-sidebar-button fa fa-bars is-hidden-desktop" id="documenter-sidebar-button" href="#"></a></div></header><article class="content" id="documenter-page"><h1 id="Strategies-for-dealing-with-missings"><a class="docs-heading-anchor" href="#Strategies-for-dealing-with-missings">Strategies for dealing with missings</a><a id="Strategies-for-dealing-with-missings-1"></a><a class="docs-heading-anchor-permalink" href="#Strategies-for-dealing-with-missings" title="Permalink"></a></h1><p>The following types support methods to deal with presence of missing values in their inputs.</p><article class="docstring"><header><a class="docstring-binding" id="LogNormals.MissingStrategy" href="#LogNormals.MissingStrategy"><code>LogNormals.MissingStrategy</code></a> — <span class="docstring-category">Type</span></header><section><div><pre><code class="language-julia">MissingStrategy()</code></pre><p>Suptertype of Abstract and Singleton Types that signify how a method should deal with missing values</p><ul><li>└<code>PassMissing</code>: Singleton: return missing, if a missing value is encountered</li><li>└<code>HandleMissingStrategy</code>: Abstract type: take missing values consciously into account<ul><li>└<code>SkipMissing</code>: ignore missing values</li><li>└<code>ExactMissing</code>: unbiased processing </li></ul></li></ul></div><a class="docs-sourcelink" target="_blank" href="https://github.com/bgctw/LogNormals.jl/blob/3abfadedf4376617ba313a1a2be97cc92cddc278/src/missingstrategy.jl#L1-L10">source</a></section></article><p>Usually, methods should return <code>missing</code> if there are missings present in the input. This <code>PassMissing()</code> strategy ensures,  that missing are not accidently bypassed unconsciously.  Hence, <code>PassMissing()</code> is a good default value for the strategy.</p><p>If a caller knows that there might by missing values present, he can consciously request to handle missings by supplying one of subtypes of <code>HandleMissingStrategy</code>. For an explicit dealing with missings that may cause some cost in computation use <code>ExactMissing</code>. For ignoring missing values use <code>SkipMissing</code>.</p><h2 id="Example:-Autocorrelation"><a class="docs-heading-anchor" href="#Example:-Autocorrelation">Example: Autocorrelation</a><a id="Example:-Autocorrelation-1"></a><a class="docs-heading-anchor-permalink" href="#Example:-Autocorrelation" title="Permalink"></a></h2><p>When dealing with autocorrelation, the position of records in the series is meaningful. Computations on a series where missing have just been skipped are biased  because distant records may have become neighbors.</p><p>The following example computes the effective number of observations, which tells how many independent observations would lead to the same uncertainty of the mean.  It assumes that the errors <span>$\epsilon_i$</span> from   observation <span>$x_i = \mu_i + \epsilon_i$</span> are generated  by the same process and have the same uncertainty.</p><pre><code class="language-julia"># acf: coefficients of the autocorrelation functions starting from lag 0 
function effective_n_cor(x, acf::AbstractVector, ms::MissingStrategy=PassMissing())
    ms == PassMissing() &amp;&amp; Missing &lt;: eltype(x) &amp;&amp; any(ismissing.(x)) &amp;&amp; return(missing)
    n = length(x)
    k = Base.OneTo(min(n,length(acf))-1) # acf starts with lag 0
    if ms == ExactMissing() &amp;&amp; (Missing &lt;: eltype(x))
        # count the number of pairs with missings for each lag
        mk = count_forlags((x_i,x_iplusk)-&gt;ismissing(x_i) || ismissing(x_iplusk), x, k)
        nf = n - count(ismissing.(x))
        neff = nf/(1 + 2/nf*sum((n .- k .-mk) .* acf[k.+1]))  
    else
        neff = n/(1 + 2/n*sum((n .- k) .* acf[k.+1]))  
    end
end</code></pre><p>The default MissingStrategy is <code>PassMissing()</code> ensuring that the caller has to think about how she wants to deal with missings to get proper results.</p><p>The formula for the standard error of the mean sums over all covariances, and  hence the formula can account for missings by counting how many covariance terms are missing. This counting scans the series for each lag, i.e distance, between records and therefore comes at a cost.</p><p>The caller can decide whether to use the costly exact number of observations by passing <code>ExactMissing()</code> or  to use a slighly positively biased estimate computed at a lower cost by passing <code>SkipMissing()</code>, for instance when she knows that the potential number of  missings is small.</p><h2 id="Type-stability"><a class="docs-heading-anchor" href="#Type-stability">Type stability</a><a id="Type-stability-1"></a><a class="docs-heading-anchor-permalink" href="#Type-stability" title="Permalink"></a></h2><p>Checking the type of inputs for allowing <code>Missing</code> in addition to checking for occurence of missings helps to generate type-stable code.</p><p>In the example above: Including the check on <code>Missing &lt;: eltype(x)</code>   leads to a inferred return type of <code>Float64</code> for <code>x::AbstractVector{Float64}</code>,  whereas omitting this check would yield <code>Union{Missing,Float64}</code>.</p><h2 id="Design-choices"><a class="docs-heading-anchor" href="#Design-choices">Design choices</a><a id="Design-choices-1"></a><a class="docs-heading-anchor-permalink" href="#Design-choices" title="Permalink"></a></h2><p>The design strategies alternatively could be passed by keyword arguments, e.g. <code>skipmissing::Bool=true</code> or by an enum type. Modelling the strategies by a type system allows the dispatch system and the  compiler to work on them. </p><p>This comes with several advantages:</p><ul><li>Avoid method matching ambiguities across existing methods that cannot handle missing values and their extensions by the same name and argument types aside from the MissingStrategy.</li><li>Generate efficient code, because <code>if</code> branches can be pruned at compile time</li><li>Extensible to further strategies</li></ul></article><nav class="docs-footer"><a class="docs-footer-prevpage" href="sumlognormals.html">« Sum LogNormals</a><a class="docs-footer-nextpage" href="semcor.html">sem correlated »</a><div class="flexbox-break"></div><p class="footer-message">Powered by <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> and the <a href="https://julialang.org/">Julia Programming Language</a>.</p></nav></div><div class="modal" id="documenter-settings"><div class="modal-background"></div><div class="modal-card"><header class="modal-card-head"><p class="modal-card-title">Settings</p><button class="delete"></button></header><section class="modal-card-body"><p><label class="label">Theme</label><div class="select"><select id="documenter-themepicker"><option value="documenter-light">documenter-light</option><option value="documenter-dark">documenter-dark</option></select></div></p><hr/><p>This document was generated with <a href="https://github.com/JuliaDocs/Documenter.jl">Documenter.jl</a> on <span class="colophon-date" title="Wednesday 10 March 2021 08:24">Wednesday 10 March 2021</span>. Using Julia version 1.5.3.</p></section><footer class="modal-card-foot"></footer></div></div></div></body></html>
